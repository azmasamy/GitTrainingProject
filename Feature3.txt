This is the reimplementaion for feature3
